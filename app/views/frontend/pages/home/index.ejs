<% include ./../../helpers/pagination %>

<% 
    function translate(str) {
        let result = '';
        switch (str) {
            case 'Nam': 
                result = 'male';
                break;
            case 'Nữ':
                result = 'female';
                break;
            default:
        }
        return result;
    }
    function createSlug(value) {
        var str = value;
        str = str.toLowerCase();
        str = str.replace(/à|á|ạ|ả|ã|â|ấ|ầ|ẩ|ẫ|ậ|ă|ắ|ằ|ẳ|ẵ|ặ/g, "a");
        str = str.replace(/è|é|ẹ|ẻ|ẽ|ê|ế|ề|ể|ễ|ệ/g, "e");
        str = str.replace(/ì|í|ị|ỉ|ĩ/g, "i");
        str = str.replace(/ò|ó|ọ|ỏ|õ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/g, "o");
        str = str.replace(/ù|ú|ụ|ủ|ũ|ư|ứ|ừ|ử|ữ|ự/g, "u");
        str = str.replace(/ỳ|ý|ỵ|ỷ|ỹ/g, "y");
        str = str.replace(/đ/g, "d");
        str = str.replace(/!|@|%|\^|\*|\(|\)|\+|\=|\<|\>|\?|\/|,|\.|\:|\;|\'|\"|\&|\#|\[|\]|~|\$|_|`|-|{|}|\||\\/g, " ");
        str = str.replace(/ *? /g, "-");
        str = str.trim();
        return str;
    }
    const folder_uploads = 'uploads/products/';
    const linkPrefix = systemConfig.prefixFrontend + `/`;
%> 

<link rel="stylesheet" href="frontend/css/home.css">

<br><br>
<div id="homeslides" class="carousel slide" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#homeslides" data-slide-to="0" class="active"></li>
        <li data-target="#homeslides" data-slide-to="1"></li>
        <li data-target="#homeslides" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="carousel-item active">
            <img src="frontend/img/banner1.jpg" alt="First slide">
        </div>
        <div class="carousel-item">
            <img src="frontend/img/banner4.jpg" alt="Second slide">
        </div>
        <div class="carousel-item">
            <img src="frontend/img/banner3.png" alt="Third slide">
        </div>
    </div>
    <a class="carousel-control-prev" href="#homeslides" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#homeslides" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>

<!-- Top views -->
<div class="container normalcards seenproduct">
    <h3 class="heading">Sản phẩm xem nhiều</h3>
    <div class="row m-0">
        <% productsMostViews.forEach((product) => { %>
            <div class="card">
                <div class="img">
                    <img class="card-img-top" src="<%= folder_uploads + product.thumb %>" alt="<%= product.thumb %>">
                </div>
                <div class="p-2">
                    <a href="/details/<%= createSlug(product.brand.name) %>/<%= createSlug(product.category.name) %>/<%= createSlug(product.name) %>" class="title">
                        <p class="mb-2"><%= product.name %></p>
                    </a>
                    <a href="/brands/<%= createSlug(product.brand.name) %>/"><small style="color:red"><%= product.brand.name %></small></a><br>
                    <a href="/categories/<%= translate(product.category.gender) %>/<%= createSlug(product.category.name) %>/"><small style="color:blueviolet"><%= product.category.name %></small></a>
                    <p class="price currentprice m-0"><%= product.price %></p>
                    <small class=""><%= product.promotion %></small>
                </div>
            </div>
        <% }) %>
    </div>
</div>

<!-- Best sell -->
<div class="container normalcards seenproduct">
    <h3 class="heading">Sản phẩm bán chạy</h3>
    <div class="row m-0">
        <div class="card">
            <div class="img">
                <img class="card-img-top" src="frontend/img/card1.jpg" alt="cardimg">
            </div>
            <div class="p-2">
                <a href="#" class="title stretched-link"><p class="mb-2">Tên sản phẩm</p></a>
                <p class="currentprice m-0">45.000đ</p>
                <p class="pastprice m-0 text-muted d-inline">45.000đ</p>
                <small class="">-10%</small>
            </div>
        </div>
    </div>
</div>


<!-- Best sell -->
<div class="container normalcards seenproduct">
    <h3 class="heading">Sản phẩm mới</h3>
    <div class="row m-0">
        <% productsNew.forEach((product) => { %>
            <div class="card">
                <div class="img">
                    <img class="card-img-top" src="<%= folder_uploads + product.thumb %>" alt="<%= product.thumb %>">
                </div>
                <div class="p-2">
                    <a href="/details/<%= createSlug(product.brand.name) %>/<%= createSlug(product.category.name) %>/<%= createSlug(product.name) %>" class="title">
                        <p class="mb-2"><%= product.name %></p>
                    </a>
                    <a href="/brands/<%= createSlug(product.brand.name) %>/"><small style="color:red"><%= product.brand.name %></small></a><br>
                    <a href="/categories/<%= translate(product.category.gender) %>/<%= createSlug(product.category.name) %>/"><small style="color:blueviolet"><%= product.category.name %></small></a>
                    <p class="price currentprice m-0"><%= product.price %></p>
                    <small class=""><%= product.promotion %></small>
                </div>
            </div>
        <% }) %>
    </div>
</div>
